<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./css/cart.css">
</head>
<body>
   <h1>REVIEW YOUR BAG</h1>
  <div id="display">
    <div id="pc-perk">
      <div>
        <img src="https://www.rodanandfields.com/en-us/_ui/images/pcperks_upsell/pc-perks-logo.png"><br>
        <span id="text_in_center1">Subscribe & Save $25.00!</span>
        <p  id="text_in_center2">Join PC Perks for $19.95 to Save 10% + Get Free Shipping on orders $80+</p>
        <a  id="view_more" href="#">View More</a><br>
        <button id="add_member">ADD MEMBERSHIP - $19.95</button>
      </div>
    
       <!-- add product div -->
   <div id="product_div">
    <select  id="incre">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3"></option>
    </select>
   </div>
 
  </div>

   
   <!-- oreder summery -->
   <div id="summery">
    <div id="border">
      <div>
        <h2>ORDER SUMMARY</h2>
        <p>SUBTOTAL</p>
        <p id="subTotal"></p>
        <p>BUNDLE SAVINGS</p>
        <p id="float_left">$0</p>
        <p>SHIPPING</p>
        <p id="float_left">Calculated At Checkout</p>
        <hr/>
        <h3>ESTIMATED TOTAL</h3>
        <h2 id="estimated"></h2>
        <p>4 interest-free payments of $51.75 with Klarna.</p>
      </div>


      <div>
       <input type="text" id="promo" placeholder="Enter Promo Code"/>
       <button id="apply_btn" onclick="apply_promo(event)">Apply</button>
       <p id="congo"></p>
      </div>
    </div>

    <br/>

     <div>
       <button id="continue_shopping">CONTINUE SHOPPING</button><br/><br/>
      <a href="checkout.html"> <button id="checkout">SECURE CHECKOUT</button></a>
     </div>





    
  </div>
</body>
</html>
<script>
let cart_data = JSON.parse(localStorage.getItem("cart"))

let showall_data = JSON.parse(localStorage.getItem("cart"))

// console.log('showall_data:', showall_data)
// console.log('cart_data:', cart_data)

var data_div = document.getElementById("product_div")

var total = 0

cart_data.forEach(function(el){
    let div1 = document.createElement("div")//add_prod
  let div2 = document.createElement("div")
  let div3 = document.createElement("div")

  let img = document.createElement("img")
  img.src = el.image

  let p_name = document.createElement("h2")
  p_name.innerText = el.name

  let dis = document.createElement("p")
  dis.innerText = el.discription

 let p_price = document.createElement("h2")
 p_price.innerText = "$"+el.price

 let remove = document.createElement("button")
 remove.textContent = "Delete"

//for delete from cart

remove.onclick = function(){
  deleteFromCart(el)
}



 div3.append(p_name,dis,p_price)

 div1.append(img,div3)

 div2.append(div1)

 data_div.append(div2,remove)


div1.setAttribute("id","add_prod")
img.setAttribute("id", "img-size")
p_name.setAttribute("id","item_name")
dis.setAttribute("id","discreaption")
p_price.setAttribute("id","add_price")
remove.setAttribute("id", "remove_btn")



var prod = document.getElementById("incre").value
console.log(prod)


total = total+ Number(el.price)



// console.log('total:', total)

})


var sub_total = document.getElementById("subTotal")
 sub_total.innerHTML = "$"+ total

 let estimated = document.getElementById("estimated")
 estimated.innerHTML = "$"+ total


 function apply_promo(e){
   e.preventDefault()
   var promo = document.getElementById("promo").value
   console.log('promo:', promo)
  var res = ""
   let estimated = document.getElementById("estimated")
  if(promo === "masai30"){
    res += Math.floor(total-total*(30/100));
    console.log('res:', res)
    let p = document.getElementById("congo")
    p.textContent = "Congrats! Your Promo Code Is Applied"
    p.setAttribute("class", "green")
    
    estimated.innerHTML =  "$"+res
}
else{
  let p = document.getElementById("congo")
    p.textContent = "Wrong Promo Code"

    p.setAttribute("class", "red")
}

 }


 function deleteFromCart(p) {
    // console.log(p);

    const cartData = JSON.parse(localStorage.getItem("cart"));

    const newData = deleteFn(cartData, p);

    localStorage.setItem("cart", JSON.stringify(newData));

    window.location.reload();

}


function deleteFn(cartData, p) {
    for (let i = 0; i < cartData.length; i++) {
        // item to delete
        const productName = p.name;

        if (cartData[i].name == productName) {
            cartData.splice(i, 1);
        }
    }

    return cartData;
}



// let showall_data = JSON.parse(localStorage.getItem("myItem"))
// console.log(showall_data)


// var detail_div = document.getElementById("product_div")

// var total1 = 0

// showall_data.forEach(function(el1){
//    let div4 = document.createElement("div")
//    let div5 = document.createElement("div")
//    let div6 = document.createElement("div")


//    let img1 = document.createElement("img")
//   img1.src = el1.image

//   let p_name1 = document.createElement("h2")
//   p_name1.innerText = el1.name

//   let dis1 = document.createElement("p")
//   dis1.innerText = el1.discription

//  let p_price1 = document.createElement("h2")
//  p_price1.innerText = "$"+el1.price

//  let remove1 = document.createElement("button")
//  remove1.textContent = "Delete"



 

//  div6.append(p_name1,dis1,p_price1)

//  div4.append(img1,div6)

//  div5.append(div4)

//  detail_div.append(div5,remove1)

// })






</script>